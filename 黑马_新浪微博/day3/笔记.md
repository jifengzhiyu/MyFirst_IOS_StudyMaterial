# 纯代码tableVC

![image-20211122202415654](%E7%AC%94%E8%AE%B0.assets/image-20211122202415654.png)

- 返回值可选，设置cell相关还要解包

![image-20211122202756962](%E7%AC%94%E8%AE%B0.assets/image-20211122202756962.png)

# gitignore

https://www.jianshu.com/p/00211429db72

https://github.com/github/gitignore

https://juejin.cn/post/6959805575475658782

# 删除main.storyboard,并设置代码启动

你去查点文章 比较新的 讲 application => scene => window => view vc 之间的层级关系的文章

你问问他知不知道有文章讲application windowScene window view层级结构的文章



UIWindowScene

UIWindow

rootViewController

https://juejin.cn/post/6844903993496305671

# MVVM

![image-20211123222234077](%E7%AC%94%E8%AE%B0.assets/image-20211123222234077.png)

MVVM 是 Model-View-ViewModel 的简写，MVVM 模式和 MVC 模式一样，主要目的是分离视图（View）和模型（Model）

# 微博

![image-20211204110435152](%E7%AC%94%E8%AE%B0.assets/image-20211204110435152.png)

![image-20211123231014254](%E7%AC%94%E8%AE%B0.assets/image-20211123231014254.png)

## 响应者链条

运行循环 监听消息

OC动态消息机制(swift没有）：给对象发送消息，对象接收消息执行，没有相应崩溃

![image-20211124155647612](%E7%AC%94%E8%AE%B0.assets/image-20211124155647612.png)

```swift
 // MARK: - 监听方法
    /// 点击撰写按钮
    /// 如果`单纯`使用 `private` 运行循环将无法正确发送消息，导致崩溃
    /// 如果使用 @objc 修饰符号，可以保证运行循环能够发送此消息，即使函数被标记为 private
    @objc private func clickComposedButton() {
        print("点我了")
    }
```

## 纯代码与xib的入口

![image-20211124171821792](%E7%AC%94%E8%AE%B0.assets/image-20211124171821792.png)

![image-20211124192628906](%E7%AC%94%E8%AE%B0.assets/image-20211124192628906.png)

上面的方法：纯代码

下面的方法：SB + 代码 

## 思考

```swift
 /**
        提问
        1. 应用程序中有几个 visitorView? - 每个控制器各自有各自不同的 访客视图！
        2. 访客视图如果用懒加载会怎样？- 如果使用懒加载，访客视图始终都会被创建出来！
    */
```

# 终端统计代码

```swift
find . -name "*.swift" | xargs wc -l
```

## extention

extension 类似于 OC 的分类，分类中不能定义`存储性`属性！Swift 中同样如此！

# 代理

VisitorTableViewController

VisitorView

![image-20211125171346626](%E7%AC%94%E8%AE%B0.assets/image-20211125171346626.png)

![image-20211125171414975](%E7%AC%94%E8%AE%B0.assets/image-20211125171414975.png)

![image-20211125171439368](%E7%AC%94%E8%AE%B0.assets/image-20211125171439368.png)

![image-20211125171457148](%E7%AC%94%E8%AE%B0.assets/image-20211125171457148.png)

## IOS监听事件的方式

代理 Block 通知 KVO（监听属性变化）

addTarget

小结:

- 使用代理传递消息是为了在控制器和视图之间解藕，让视图能够被多个控制器复用，例如 `UITableView`
- 但是，如果视图仅仅只是为了封装代码，而从控制器中剥离出来的，并且能够确认该视图不会被其他控制器引用，则可以直接通过 `addTarget` 的方式为该视图中的按钮添加监听方法
- 这样做的代价是耦合度高，控制器和视图绑定在一起，但是会省略部分冗余代码

代理的使用:

- `swift` 中代理的使用基本与 OC 相同
- 需要注意的是，定义协议时，需要继承自 `NSObjectProtocol`
- 代理属性需要使用 `weak` 防止出现循环引用

# 调试返回数据格式

![image-20211129150813834](%E7%AC%94%E8%AE%B0.assets/image-20211129150813834.png)

如果服务器返回的信息无法从文档获取

 // 如果是 NSNumber，则没有引号！在做 KVC 指定属性类型非常重要！

# Swift归档接档

1、遵守NSCoding

![image-20211129192713864](%E7%AC%94%E8%AE%B0.assets/image-20211129192713864.png)

2、写归档解档方法

![image-20211129193518002](%E7%AC%94%E8%AE%B0.assets/image-20211129193518002.png)

注意：// 在 extension 中只允许写 便利构造函数，而不能写指定构造函数

// 不能定义存储型属性，定义存储型属性，会破坏类本身的结构！

```swift
  // 2. 从 Xcode 7 beta 5 开始 stringByAppendingPathComponent 转为 NSString 特有
        // 单纯的 as 在 Swift 中大多只有三个地方会用 `桥接`
        // 1> String as NSString
        // 2> NSArray as [array]
        // 3> NSDictionary as [String: AnyObject]
```

3、封装

![ ](%E7%AC%94%E8%AE%B0.assets/image-20211129200058200.png)

# as三个使用场景

1

```swift
 // 1> String as NSString
        // 2> NSArray as [array]
        // 3> NSDictionary as [String: AnyObject]
```

2

```swift
        access_token = aDecoder.decodeObjectForKey("access_token") as? String
//access_token可选steing ---》 后面 as?String

```

3 guard let, if let

```swift
guard let dict = result as? [String: AnyObject] else  {
                print("格式错误")
                return
            }
```

# 切换控制器注意

切换控制器要保证 上一个控制器已经被销毁了

![image-20211202093248905](%E7%AC%94%E8%AE%B0.assets/image-20211202093248905.png)

![image-20211202153656760](%E7%AC%94%E8%AE%B0.assets/image-20211202153656760.png)

# KVC模型套模型

```swift
init(dict: [String: Any]) {
        super.init()
        
        // 如果使用 KVC 时，value 是一个字典，会直接给属性转换成字典
        setValuesForKeys(dict)
    }
    
    //setValuesForKeys(dict) 多次调用下面
    override func setValue(_ value: Any?, forKey key: String) {
        
        // 判断 key 是否是 user
        if key == "user" {
            if let dict = value as? [String: AnyObject] {
                
                user = User(dict: dict)
            }
            //⚠️
            return 
        }
        
        super.setValue(value, forKey: key)
    }
```

# 创建图片

![image-20211203231128994](%E7%AC%94%E8%AE%B0.assets/image-20211203231128994.png)

# 自动计算高度 automaticDimension

```swift
// 自动计算行高 - 需要一个自上而下的自动布局的控件，指定一个向下的约束
        tableView.estimatedRowHeight = 200
        tableView.rowHeight = UITableView.automaticDimension
```

![image-20211203235638411](%E7%AC%94%E8%AE%B0.assets/image-20211203235638411.png)

# 使没有父类的自定义类拥有重写

1 遵守 

```swift
class StatusViewModel: CustomStringConvertible
```

2实现方法

```swift
/// 描述信息
    var description: String {
//        return status.description + "配图数组 \(thumbnailUrls ?? [] as NSArray)"
        return status.description
    }
```

# 转发

![image-20211206170631045](%E7%AC%94%E8%AE%B0.assets/image-20211206170631045.png)

# SDWebImage介绍 

![image-20211207111831919](%E7%AC%94%E8%AE%B0.assets/image-20211207111831919.png)

看第三方框架 interface有最核心的方法

swift用kingfisher吧

sbwebimg用的oc

# 临界点判断

![image-20211208153746989](%E7%AC%94%E8%AE%B0.assets/image-20211208153746989.png)

