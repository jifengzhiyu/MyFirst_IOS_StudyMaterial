 # 数据库介绍

一个应用程序，有一个唯一的数据库文件

![image-20211219104933189](%E7%AC%94%E8%AE%B0.assets/image-20211219104933189.png)

![image-20211219105600261](%E7%AC%94%E8%AE%B0.assets/image-20211219105600261.png)

![image-20211219115751996](%E7%AC%94%E8%AE%B0.assets/image-20211219115751996.png)

主键：

![image-20211219121616223](%E7%AC%94%E8%AE%B0.assets/image-20211219121616223.png)

![image-20211219121834289](%E7%AC%94%E8%AE%B0.assets/image-20211219121834289.png)

![image-20211219121852359](%E7%AC%94%E8%AE%B0.assets/image-20211219121852359.png)

![image-20211219122038944](%E7%AC%94%E8%AE%B0.assets/image-20211219122038944.png)



# Navicat Premilum使用

单引号===字符串(**别用双引号**)

单引号/不加任何，用于表名  

## 创建表格

设置主键：
![ ](%E7%AC%94%E8%AE%B0.assets/image-20211219122138232.png)

相当于设置属性

![image-20211219153133439](%E7%AC%94%E8%AE%B0.assets/image-20211219153133439.png)

![image-20211219153730577](%E7%AC%94%E8%AE%B0.assets/image-20211219153730577.png)

```sql
/**
	CREATE TABLE 	-- 创表
	IF NOT EXISTS	-- 判断数据表是否存在，如果存在，不再执行创表 SQL
	'T_Person'		-- 表名
	(
		字段1 INTEGER(整数) / REAL(小数) / TEXT(字符串) / BLOB(二进制数据-通常不会保存在数据库中)
			NOT NULL		不允许为空，主键必须有内容
			PRIMARY KEY		主键
			AUTOINCREMENT	自动增长
		,	区分各个字段，最后一个字段不需要 ','
		字段2 类型,
		...
	)

	使用细节：
	1. 来源，可以复制粘贴
	2. 建议使用单引号，可以避免在程序中转义
	3. IF NOT EXISTS 需要单独增加，为了保证 SQL 语句可以不断的被重复执行！
	4. 每条 SQL 语句的末尾，建议添加一个 ';' 表示一个完整的 SQL 结束
		一条 SQL 是否有 ; 直接表明是不是有过数据库开发经验的人！
*/
CREATE TABLE IF NOT EXISTS 'T_Person' (
	 "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	 "name" TEXT,7
	 "age" INTEGER,
	 "height" REAL
);
```

## 插入表格

```sql
/**

	INSERT INTO '表名'
		(字段1, 字段2...)
	VALUES
		(值1, 值2);

	注意：
	1. 字段和值的顺序必须保持一致

	提示：
	SQLite本质上不区分数据类型，怎么存都行，定义表结构的时候，指定的类型只是给程序员看的！

	强烈建议：不要乱存！
*/

INSERT INTO 'T_Person'
(name, age, height)
VALUES
('张三', 18, 1.5);
```

## 删除

```sql
/**
	DELETE FROM '表名'
	WHERE 主键 = id;

	注意：删除语句一定要写 WHERE！否则会删除所有数据！后果很严重！

	* 如果指定的条件不存在，SQL 会执行，但是影响行数为0
*/
DELETE FROM 'T_Person'
WHERE id = 3000;

```

## 更新 

```sql
/**
	UPDATE '表名	'
	set
		字段1 = '字符串值1',
		字段2 = 值2,
		...
	WHERE(条件)
		主键 = id;

	提示：
	* 一定要写条件，否则会修改所有的记录
	* 如果指定的条件不存在，SQL 会执行，但是影响行数为0
*/

UPDATE 'T_Person' set name = '老王', age = 80, height = 1.2 
WHERE id = 10000;
```

## 查询

```sql
-- 查询所有记录，但是：开发中不建议写 *，通配符，直接阅读代码无法知道查询返回的内容
-- 可以用在测试中，程序代码中，强烈不推荐！
SELECT * FROM T_Person;

-- 开发中建议使用的，便于阅读
SELECT id, name, height, age FROM T_Person;

-- 统计查询
SELECT count(*) FROM T_Person;

-- 指定条件统计查询
SELECT count(*) FROM T_Person WHERE height > 1.5;

-- 查询年龄最大的人
-- 应用场景：查询经验最高的值，最近加入的人...
SELECT max(age) FROM T_Person;

-- 分页功能
-- LIMIT 从第几条记录开始(起始条数是 0), 返回的记录行数
SELECT id, name, height, age FROM T_Person
LIMIT 0, 2;

-- LIMIT 和条件指令 WHERE 组合使用，可以很方便的作出分页功能
SELECT id, name, height, age FROM T_Person
WHERE id >= 2
LIMIT 2;

-- 排序功能，默认是升序 ASC / 降序 DESC
-- 排序是按照指定的条件，由左至右依次排列
SELECT id, name, height, age FROM T_Person
ORDER BY name DESC, age ASC;

-- 模糊查询
-- % 可以匹配任何内容 
-- %内容% 表示只要出现内容，都会被搜索出来
-- 逻辑判断 AND OR NOT
SELECT id, name, height, age FROM T_Person
WHERE (name LIKE '%a%' AND age > 20) OR name = 'li';

```

## 插入或更改

![image-20211222094727686](%E7%AC%94%E8%AE%B0.assets/image-20211222094727686.png)

# xcode使用SQLite

![image-20211219184331510](%E7%AC%94%E8%AE%B0.assets/image-20211219184331510.png)

![image-20211219192947732](%E7%AC%94%E8%AE%B0.assets/image-20211219192947732.png)

桥接文件：头文件

![image-20211219194916436](%E7%AC%94%E8%AE%B0.assets/image-20211219194916436.png)

网络，数据库多单例 

# 事务

![image-20211220231933920](%E7%AC%94%E8%AE%B0.assets/image-20211220231933920.png)

# FMDB

![image-20211221103618100](%E7%AC%94%E8%AE%B0.assets/image-20211221103618100.png)

除了查询，都用update

![image-20211221173922045](%E7%AC%94%E8%AE%B0.assets/image-20211221173922045.png)

 ![image-20211221222530090](%E7%AC%94%E8%AE%B0.assets/image-20211221222530090.png)

# 队列的嵌套

![image-20211221204413191](%E7%AC%94%E8%AE%B0.assets/image-20211221204413191.png)

