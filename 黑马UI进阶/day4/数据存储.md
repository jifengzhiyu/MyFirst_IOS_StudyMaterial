# 数据存储

![image-20211002095639784](%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002095639784.png)

# 沙盒

![image-20211002095735117](%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002095735117.png)

沙盒：数据存储到哪里

![image-20211002102359852](%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002102359852.png)

- 持久化：保存到硬盘里

- Caches：缓存  

比如图片啥的

![image-20211002103206721](%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002103206721.png)

沙盒的路径会变

使用iSandBox软件，直接可以点击进入该应用的沙盒路径

# plist存储

```objective-c
- (IBAction)save:(id)sender {
    //获取doc路径
    //1、1拼接字符串
//    NSString *homePath = NSHomeDirectory();
//    NSString *docPath = [homePath stringByAppendingString:@"/Documents"];
//    NSLog(@"%@",docPath);
    
    //1、2拼接字符串
//    NSString *homePath = NSHomeDirectory();
//    NSString *docPath = [homePath stringByAppendingPathComponent:@"Documents"];
//    NSLog(@"%@",docPath);
    
    //2、搜索（用这个
    //返回NSArray<NSString *> *
    //找到同名文件里面我们想要的那个，因为doc不可能有同名文件所以[0]
    NSString *docPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)[0];
    NSLog(@"%@",docPath);
    
    //存数据
    NSString *filePath = [docPath stringByAppendingPathComponent:@"xx.plist"];
    //数组
//    NSArray *array = @[@"1",@"asdasd",@"速度速度"];
//    [array writeToFile:filePath atomically:YES];
    //如果之前该文件已经存储数据，那么之前的数据就会被替换
    
    NSDictionary *dict = @{@"key" : @"value"};
    [dict writeToFile:filePath atomically:YES];
    
    
    
}


- (IBAction)read:(id)sender {
    //获取doc路径
    NSString *docPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)[0];
    //获取文件路径
    NSString *filePath = [docPath stringByAppendingPathComponent:@"xx.plist"];
    //解析
    //数组
    //NSArray *array = [NSArray arrayWithContentsOfFile:filePath];
//    NSLog(@"%@",array);

    NSDictionary *dict = [NSDictionary dictionaryWithContentsOfFile:filePath];
    NSLog(@"%@",dict);
    
}
```

![image-20211002222149766](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002222149766.png)

![image-20211002222708691](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002222708691.png)

- 

![image-20211002222854463](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002222854463.png)

一般都写YES：会把信息先分割放着缓存里面，再一个个放在硬盘里面

# 偏好设置 

- NSUserDefaults一个专门做偏好设置的类（字典数组

- 一个类方法 以standerd / shared 开头一般都是 单例对象

不论在那里输出该对象，单例对象的内存地址只有一个

![image-20211002114350562](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002114350562.png)

![image-20211002114503659](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002114503659.png)

偏好设置文件名：com.jifengzhiyu-github.www.----.plist

bondel Identifer名字

**一定要同步！！**

# 归档解档

- 又改接口了

- 自定义对象的存取

主要看前两个

https://blog.csdn.net/streamery/article/details/103331296?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_ecpm_v1~rank_aggregation-7-103331296.pc_agg_rank_aggregation&utm_term=ios+%E5%BD%92%E6%A1%A3%E8%A7%A3%E6%A1%A3&spm=1000.2123.3001.4430

https://blog.csdn.net/A1521315qwss/article/details/117771477?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163317034416780261979418%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=163317034416780261979418&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-12-117771477.pc_search_ecpm_flag&utm_term=iOS+%E6%95%B0%E6%8D%AE%E5%BD%92%E6%A1%A3%E8%A7%A3%E6%A1%A3&spm=1018.2226.3001.4187





https://blog.csdn.net/chase20150628/article/details/89424017

https://blog.csdn.net/Q_Q33757152/article/details/111294953

- 如果存储自定义数组：

看day3通讯录

self.contacts = (NSMutableArray *)[NSKeyedUnarchiver unarchivedArrayOfObjectsOfClass:[Contact class] fromData:data error:nil];

![image-20211002224119503](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211002224119503.png)

# 滑动删除

滑动之后点击删除 才会调用

```objective-c
 - (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath{
        //把数组里的元素删除
        [self.contacts removeObjectAtIndex:indexPath.row];
        
        //删除一行
        [self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationLeft];
        //该方法自动调用数据源方法（刷新 ，并且可以指定动画
        //传进去数组的原因：可以删除多个cell
    }
```

- 上下这两个语句的先后顺序不能调换

tableView里面有一个专门记录当前cell个数的数组

如果先删除cell。即上一行的数组元素个数会-1

之后会与数据源里面，contacts元素数组的个数相对比，但是这个时候contacts也就是数据源的数组个数没有改变，产生了矛盾

# UITableBarController

- 和UINavigationController类似，是管理控制器的控制器（完成控制器之间的跳转

![image-20211003100146864](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003100146864.png)

1、![image-20211003100348460](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003100348460.png)

![image-20211003101259404](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003101259404.png)

2、SceneDelegate.m里面

```objective-c
- (void)scene:(UIScene *)scene willConnectToSession:(UISceneSession *)session options:(UISceneConnectionOptions *)connectionOptions {
    // Use this method to optionally configure and attach the UIWindow `window` to the provided UIWindowScene `scene`.
    // If using a storyboard, the `window` property will automatically be initialized and attached to the scene.
    // This delegate does not imply the connecting scene or session are new (see `application:configurationForConnectingSceneSession` instead).
    
    //1、创建window
    self.window = [[UIWindow alloc] initWithWindowScene:(UIWindowScene *)scene];
   //2.1初始化UITableBarController
    UITabBarController *tabbarController = [[UITabBarController alloc] init];
    //2.2创建子控制器
    UIViewController *v1 = [[UIViewController alloc] init];
    UIViewController *v2 = [[UIViewController alloc] init];
    UIViewController *v3 = [[UIViewController alloc] init];
    //2.3设置背景色
    v1.view.backgroundColor = [UIColor redColor];
    v2.view.backgroundColor = [UIColor blueColor];
    v3.view.backgroundColor = [UIColor purpleColor];
    //2.4添加子控制器
    //UITableBarController显示第一个添加的控制器，导航控制器显示最后一个添加的控制器
    [tabbarController addChildViewController:v1];
    [tabbarController addChildViewController:v2];
    [tabbarController addChildViewController:v3];
    //3、设置window根控制器
    self.window.rootViewController = tabbarController;
    //4、显示
    [self.window makeKeyAndVisible];
    //导航控制器需要依赖于一个控制器，但是UITableBarController不需要
}
```

# UITabBar

![image-20211003102117042](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003102117042.png)

![image-20211003102259152](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003102259152.png)

# UITabBarController的结构

![image-20211003181919823](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003181919823.png)

- UITabBarController专门有一个View 来存放子控制器的view(UINavigationController同理)

这个view来负责显示(也就是之前说过的栈)

1，2，view

同理，push之后1view不会被销毁

Pop,之后2view会被销毁

![image-20211003182836645](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003182836645.png)

- 所有的子控制器都一次性加载

 ![image-20211003182905431](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003182905431.png)

# 主流框架

一种主流

上有导航栏，下有tableBar，tableView

![image-20211003183910318](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003183910318.png)

 

![image-20211003184340245](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003184340245.png)

- 选择上面设计模式的原因：

需要tabBar不变，导航栏变

![image-20211003185030605](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003185030605.png)

- 想设置![image-20211003191055184](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003191055184.png)

要在UITableBarController的子控制器里面设置

![image-20211003191213722](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003191213722.png)



- 隐藏tableBar

![image-20211003194338078](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003194338078.png)

## 在故事版里面添加子控制器

![image-20211003185320135](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003185320135.png)

![image-20211003185332334](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003185332334.png)

## 在故事版里面添加根控制器

![image-20211003185958751](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003185958751.png)

# 图片大小适配

```objective-c
UIImageView *imageView = [[UIImageView alloc] init];
    imageView.image = [UIImage imageNamed:@"32"];
    [imageView sizeToFit];
    [self.view addSubview:imageView];
```

![image-20211003201253455](../day3/day3/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.assets/image-20211003201253455.png)

# 静态单元格不写数据源方法

- 自定义UIViewController来控制静态单元格，不写数据源方法
